<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The Crank-Nicolson method applied to an accelerating domain in Python | georg.io</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="The Crank-Nicolson method applied to an accelerating domain in Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python" />
<meta property="og:description" content="In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python" />
<link rel="canonical" href="https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html" />
<meta property="og:url" content="https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html" />
<meta property="og:site_name" content="georg.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-01-08T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html"},"@type":"BlogPosting","url":"https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html","headline":"The Crank-Nicolson method applied to an accelerating domain in Python","dateModified":"2014-01-08T00:00:00-06:00","datePublished":"2014-01-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://georg.io/feed.xml" title="georg.io" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-45212489-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>The Crank-Nicolson method applied to an accelerating domain in Python | georg.io</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="The Crank-Nicolson method applied to an accelerating domain in Python" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python" />
<meta property="og:description" content="In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python" />
<link rel="canonical" href="https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html" />
<meta property="og:url" content="https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html" />
<meta property="og:site_name" content="georg.io" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-01-08T00:00:00-06:00" />
<script type="application/ld+json">
{"description":"In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python","mainEntityOfPage":{"@type":"WebPage","@id":"https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html"},"@type":"BlogPosting","url":"https://georg.io/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html","headline":"The Crank-Nicolson method applied to an accelerating domain in Python","dateModified":"2014-01-08T00:00:00-06:00","datePublished":"2014-01-08T00:00:00-06:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://georg.io/feed.xml" title="georg.io" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-45212489-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script type="text/javascript">
require.config({
  paths: {
    jquery: 'https://code.jquery.com/jquery-3.5.0.min',
    plotly: 'https://cdn.plot.ly/plotly-latest.min'
  },

  shim: {
    plotly: {
      deps: ['jquery'],
      exports: 'plotly'
    }
  }
});
</script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">georg.io</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The Crank-Nicolson method applied to an accelerating domain in Python</h1><p class="page-description">In this article we adapt numerical solvers for partial differential equations to handle dynamic domain sizes in Python</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2014-01-08T00:00:00-06:00" itemprop="datePublished">
        Jan 8, 2014
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      7 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#python">python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#numpy">numpy</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#numerical analysis">numerical analysis</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#partial differential equations">partial differential equations</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/waltherg/georgio_fastpages/tree/master/_notebooks/2014-01-08-Reaction_Diffusion_Accelerating_Domain.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/waltherg/georgio_fastpages/master?filepath=_notebooks%2F2014-01-08-Reaction_Diffusion_Accelerating_Domain.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/waltherg/georgio_fastpages/blob/master/_notebooks/2014-01-08-Reaction_Diffusion_Accelerating_Domain.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h1"><a href="#Reaction-Diffusion-System-on-an-Accelerating-Domain">Reaction Diffusion System on an Accelerating Domain </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2014-01-08-Reaction_Diffusion_Accelerating_Domain.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Reaction-Diffusion-System-on-an-Accelerating-Domain">
<a class="anchor" href="#Reaction-Diffusion-System-on-an-Accelerating-Domain" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reaction Diffusion System on an Accelerating Domain<a class="anchor-link" href="#Reaction-Diffusion-System-on-an-Accelerating-Domain"> </a>
</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a <a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain">previous blog post</a> we derived equations
that describe the time behaviour of a reaction-diffusion system on a growing space domain.</p>
<p>In that work we assumed that the velocity of domain growth is an increasing function of
one of the two unknown variables (here, protein concentrations) described by our
reaction diffusion system.</p>
<p>Let us add another layer to this problem and assume that <strong>not the growth velocity</strong> is
dependend on the unknown protein concentration but that <strong>the growth acceleration</strong> is
a function of this unknown concentration.</p>
<p>We derived the equations that describe the time dynamics of our previous (velocity) problem
in material coordinates 
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#specification_of_the_local_growth_velocity">here</a>
and reproduce them for clarity:</p>
<p>
$$\frac{\partial u}{\partial t} = \frac{D_u}{g^2} \frac{\partial^2 u}{\partial X^2} - \left( D_u \frac{g_X}{g^3} + \frac{a}{g} \right) \frac{\partial u}{\partial X} + f(u,v) - \frac{a_X}{g} u,$$
</p>
<p>
$$\frac{\partial v}{\partial t} = \frac{D_v}{g^2} \frac{\partial^2 v}{\partial X^2} - \left( D_v \frac{g_X}{g^3} + \frac{a}{g} \right) \frac{\partial v}{\partial X} - f(u,v) - \frac{a_X}{g} v,$$
</p>
<p>
$$\frac{\partial g}{\partial t} = \frac{\partial a}{\partial X},$$
</p>
<p>taken with initial and boundary conditions for $u$, $v$, and $g$ as
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain">described earlier</a>.</p>
<p>Let us now introduce a fourth equation to this system to describe the time behaviour of
the growth velocity $a$ as a function of its acceleration:</p>
<p>
$$\frac{\partial a}{\partial t} = s(X,t),$$
</p>
<p>where $s(X,t)$ is the local growth acceleration.</p>
<p>In this expanded system of partial differential equations the time behaviour of the, now, unknown variable $a$
is described by an uncoupled partial differential equation.
Since there is no spatial coupling in this partial differential equation, we do not need to impose
any boundary conditions.
As initial condition, we will assume that the system is at rest at first:</p>
<p>
$$a(X,0) = 0.$$
</p>
<p>Let us now modify our 
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">previous code</a>
to simulate this expanded system.</p>
<p>Most of this code is just a copy-and-paste of our
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">previous code</a>
so please refer to our comments there if anything is unclear.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">integrate</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">J</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">dX</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">J</span><span class="p">)</span>
<span class="n">X_grid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">dX</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="n">dX</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="p">)])</span>
<span class="n">x_grid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">j</span><span class="o">*</span><span class="n">dX</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>

<span class="n">T</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">dt</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">t_grid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">n</span><span class="o">*</span><span class="n">dt</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">D_v</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mf">10.</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">100.</span><span class="p">)</span>
<span class="n">D_u</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">D_v</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">k0</span> <span class="o">=</span> <span class="mf">0.067</span>
<span class="n">f_vec</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> 
                     <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k0</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">U</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">U</span><span class="p">))))),</span> <span class="n">U</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The initial condition for the growth velocity <code>a</code> is set to zero everywhere so that the space domain is at rest at first.</p>
<p>The expression for the growth acceleration <code>s</code> is the exact same expression we used
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">earlier</a>
for the growth velocity.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_protein</span> <span class="o">=</span> <span class="mf">2.26</span>

<span class="n">no_high</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">no_high</span><span class="p">,</span><span class="n">J</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mf">2.</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">no_high</span><span class="p">)])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">total_protein</span><span class="o">-</span><span class="n">dX</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">U</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">J</span><span class="o">*</span><span class="n">dX</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">J</span><span class="p">)])</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="p">)])</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="p">)])</span>
<span class="n">s</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">U</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.001</span><span class="o">*</span><span class="n">X_grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">U</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is the <em>polarized</em> initial condition we choose for our concentration system <code>U</code> and <code>V</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">))</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'concentration'</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">U</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, the initial condition for the slope <code>g</code> of the trajectories $G$ is <code>1.</code> everywhere:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Initially, <code>s</code> looks the same as <code>a</code> did in our <a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">previous code</a>,
while in this version of our code <code>a</code> is set initially to <code>0.</code> everywhere:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">s</span><span class="p">(</span><span class="n">U</span><span class="p">))</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-.</span><span class="mi">0001</span><span class="p">,</span> <span class="mf">0.0021</span><span class="p">))</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># syntax to get one element in an array: http://stackoverflow.com/a/7332880/3078529</span>
<span class="n">a_left</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">]))</span>
<span class="n">a_right</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f_vec_u</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">f_vec</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">),</span>
                                         <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">a_left</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a_right</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span>
                                                        <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="p">)),</span>
                                                                       <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">g</span><span class="p">))))</span>

<span class="n">f_vec_v</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="n">f_vec</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">)),</span>
                                         <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">a_left</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a_right</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span>
                                                        <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="p">)),</span>
                                                                       <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">g</span><span class="p">))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sigma_u_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">D_u</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
<span class="n">sigma_v_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">D_v</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># syntax to get one element in an array: http://stackoverflow.com/a/7332880/3078529</span>
<span class="n">g_left</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">]))</span>
<span class="n">g_right</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rho_u_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="o">-</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span>
                                                <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">g_left</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">g_right</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span>
                                                               <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">D_u</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                                                            <span class="n">numpy</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))))</span>
<span class="n">rho_v_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="o">-</span><span class="n">dt</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                      <span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span>
                                                <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">g_left</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">g_right</span><span class="p">(</span><span class="n">g</span><span class="p">)),</span>
                                                               <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">D_v</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span><span class="p">),</span>
                                                                            <span class="n">numpy</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that here we use slightly more meaningful variable names for the ODE steppers for <code>g</code> and <code>x_grid</code> than
in our <a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">previous code</a>.</p>
<p>The ODE stepper for <code>a</code> is of the same form except that the right-hand side is governed by the
growth acceleration <code>s</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">g_rhs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">a_left</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="n">a_right</span><span class="p">(</span><span class="n">a</span><span class="p">)),</span>
                                     <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dX</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mf">2.</span><span class="o">*</span><span class="n">dX</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">J</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="n">dX</span><span class="p">]))</span>

<span class="n">g_stepper</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">ode</span><span class="p">(</span><span class="n">g_rhs</span><span class="p">)</span>
<span class="n">g_stepper</span> <span class="o">=</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">'dopri5'</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">g_stepper</span> <span class="o">=</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">g_stepper</span> <span class="o">=</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_rhs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">s</span>

<span class="n">a_stepper</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">ode</span><span class="p">(</span><span class="n">a_rhs</span><span class="p">)</span>
<span class="n">a_stepper</span> <span class="o">=</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">'dopri5'</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">a_stepper</span> <span class="o">=</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">a_stepper</span> <span class="o">=</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">U</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_grid_rhs</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">x_grid</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="mf">0.</span><span class="p">],</span>
                                                     <span class="n">numpy</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">]),</span> <span class="mf">2.</span><span class="p">),</span>
                                                     <span class="n">a</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">J</span><span class="p">]))</span>

<span class="n">x_stepper</span> <span class="o">=</span> <span class="n">integrate</span><span class="o">.</span><span class="n">ode</span><span class="p">(</span><span class="n">x_grid_rhs</span><span class="p">)</span>
<span class="n">x_stepper</span> <span class="o">=</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">set_integrator</span><span class="p">(</span><span class="s1">'dopri5'</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">max_step</span><span class="o">=</span><span class="n">dt</span><span class="p">)</span>
<span class="n">x_stepper</span> <span class="o">=</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">set_initial_value</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
<span class="n">x_stepper</span> <span class="o">=</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">U_record</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">V_record</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">g_record</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">a_record</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">x_record</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">U_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
<span class="n">V_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">g_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="n">a_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">x_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now integrate this system for a total of <code>N</code> time points.</p>
<p>Notice that we update the ODE stepper of <code>g</code>, <code>a</code> and <code>x_grid</code> every time step with the current state
of their corresponding right-hand-side expressions.
This is done with a call to <code>.set_f_params()</code> on the corresponding objects.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">):</span>
    <span class="n">sigma_u</span> <span class="o">=</span> <span class="n">sigma_u_func</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">sigma_v</span> <span class="o">=</span> <span class="n">sigma_v_func</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">rho_u</span> <span class="o">=</span> <span class="n">rho_u_func</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">rho_v</span> <span class="o">=</span> <span class="n">rho_v_func</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    
    <span class="n">A_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="o">-</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="mf">1.</span><span class="o">+</span><span class="n">sigma_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">rho_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">+</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">rho_u</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_u</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="n">B_u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">rho_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="mf">1.</span><span class="o">-</span><span class="n">sigma_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">rho_u</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">-</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">rho_u</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">sigma_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_u</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="n">A_v</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="o">-</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="mf">1.</span><span class="o">+</span><span class="n">sigma_v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">rho_v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">+</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">rho_v</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_v</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">1</span><span class="p">)</span>
        
    <span class="n">B_v</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">rho_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="p">)],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="mf">1.</span><span class="o">-</span><span class="n">sigma_v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">rho_v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="mf">1.</span><span class="o">-</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">rho_v</span><span class="p">[</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span> <span class="o">+</span>\
          <span class="n">numpy</span><span class="o">.</span><span class="n">diagflat</span><span class="p">([</span><span class="n">sigma_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="n">rho_v</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">J</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="mi">1</span><span class="p">)</span>
            
    <span class="n">U_new</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_u</span><span class="p">,</span> <span class="n">B_u</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">)</span> <span class="o">+</span> <span class="n">f_vec_u</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">V_new</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_v</span><span class="p">,</span> <span class="n">B_v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">f_vec_v</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    
    <span class="k">while</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">&lt;</span> <span class="n">ti</span><span class="o">*</span><span class="n">dt</span><span class="p">:</span>
        <span class="n">a_stepper</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">a_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">&lt;</span> <span class="n">ti</span><span class="o">*</span><span class="n">dt</span><span class="p">:</span>
        <span class="n">g_stepper</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">g_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">successful</span><span class="p">()</span> <span class="ow">and</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">&lt;</span> <span class="n">ti</span><span class="o">*</span><span class="n">dt</span><span class="p">:</span>
        <span class="n">x_stepper</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">x_stepper</span><span class="o">.</span><span class="n">t</span> <span class="o">+</span> <span class="n">dt</span><span class="p">)</span>
        
    <span class="n">g_stepper</span> <span class="o">=</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">x_stepper</span> <span class="o">=</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">a_stepper</span> <span class="o">=</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">set_f_params</span><span class="p">(</span><span class="n">s</span><span class="p">(</span><span class="n">U</span><span class="p">))</span>
    
    <span class="n">U</span> <span class="o">=</span> <span class="n">U_new</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">V_new</span>
    
    <span class="c1"># these are the correct "y" values to save for the current time step since</span>
    <span class="c1"># we integrate only up to t &lt; ti*dt</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">g_stepper</span><span class="o">.</span><span class="n">y</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">a_stepper</span><span class="o">.</span><span class="n">y</span>
    <span class="n">x_grid</span> <span class="o">=</span> <span class="n">x_stepper</span><span class="o">.</span><span class="n">y</span>
    
    <span class="n">U_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
    <span class="n">V_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">g_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">a_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">x_record</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x_grid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As in our
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain#python_code">previous code</a>
protein mass is conserved by definition of our boundary conditions for <code>U</code> and <code>V</code>.</p>
<p>To make certain that our numerical integration does conserve protein mass (at least to
some sensible degree) we work out the initial total mass and final total mass respectively:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">U_record</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">V_record</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">U_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span><span class="n">V_record</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These numbers look good and we therefore assume that our numerical integration is somewhat stable.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A look at a kymograph of the concentration of <code>U</code> reveals that the initial condition on <code>U</code> is
lost quickly - which will be due to reasons we discussed
<a href="http://georg.io/2013/12/Reaction_Diffusion_Growing_Domain">earlier</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">U_record</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">U_record</span><span class="p">)</span>
<span class="n">V_record</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">V_record</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'t'</span><span class="p">)</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x_record</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t_grid</span><span class="p">,</span> <span class="n">U_record</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="n">colorbar</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
<span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">'concentration U'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since with the above setup <strong>we only introduce acceleration and no deceleration</strong>, we are not surprised
to observe that the growth velocity simply increases over time:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a_record</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">a_record</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'t'</span><span class="p">)</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">t_grid</span><span class="p">,</span> <span class="n">a_record</span><span class="p">)</span>
<span class="n">colorbar</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
<span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">'local growth velocity a(X,t)'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This continual increase in growth velocity is only due to an initial
acceleration due to the initial condition we imposed on <code>U</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'X'</span><span class="p">);</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'t'</span><span class="p">)</span>
<span class="n">s_record</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">J</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ti</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">s_record</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">(</span><span class="n">U_record</span><span class="p">[</span><span class="n">ti</span><span class="p">])</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">X_grid</span><span class="p">,</span> <span class="n">t_grid</span><span class="p">,</span> <span class="n">s_record</span><span class="p">)</span>
<span class="n">colorbar</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
<span class="n">colorbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">'local growth acceleration s'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="waltherg/georgio_fastpages"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/python/numpy/numerical%20analysis/partial%20differential%20equations/2014/01/08/Reaction_Diffusion_Accelerating_Domain.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>My personal blog on tech and data</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/waltherg" title="waltherg"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://www.linkedin.com/in/georgwalther" title="georgwalther"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg></a></li><li><a rel="me" href="https://twitter.com/GeorgRWalther" title="GeorgRWalther"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
